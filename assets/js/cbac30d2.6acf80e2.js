"use strict";(self.webpackChunkanthology_dev_docs=self.webpackChunkanthology_dev_docs||[]).push([[503],{15680:(e,t,n)=>{n.d(t,{xA:()=>l,yg:()=>m});var a=n(96540);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var d=a.createContext({}),c=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},l=function(e){var t=c(e.components);return a.createElement(d.Provider,{value:t},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,d=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=c(n),p=i,m=u["".concat(d,".").concat(p)]||u[p]||h[p]||r;return n?a.createElement(m,o(o({ref:t},l),{},{components:n})):a.createElement(m,o({ref:t},l))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=p;var s={};for(var d in t)hasOwnProperty.call(t,d)&&(s[d]=t[d]);s.originalType=e,s[u]="string"==typeof e?e:i,o[1]=s;for(var c=2;c<r;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},88478:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>y,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var a=n(58168),i=(n(96540),n(15680));const r={title:"Payment Reversals using APIs",id:"studentapi-paymentreversal-details",sidebar_position:1,author:"Jim Burns",published:"",edited:""},o=void 0,s={unversionedId:"student/best-practices/studentapi-paymentreversal-details",id:"student/best-practices/studentapi-paymentreversal-details",title:"Payment Reversals using APIs",description:"A common use case for integrators is the need to reverse a payment received.  Alternative terminology for a payment reversal can be to void the payment, refund the entire payment or refund a portion of the payment that was received.  The correct way to handle via the Anthology Student APIs will depend on the specific use case/requirement the integrator needs to achieve.  The two APIs that will be covered within this document are api/commands/StudentAccounts/StudentAccountTransaction/voidAccountTransactionPayment and api/student-accounting/ledger-refund-transactions.  The voidAccountTransactionPayment API can be used ONLY if the entire payment is being reversed.  The ledger-refund-transactions can be used for full or partial payment reversals.  Details of using each of these APIs are outlined below.",source:"@site/docs/student/best-practices/PaymentReversalUsingAPI.md",sourceDirName:"student/best-practices",slug:"/student/best-practices/studentapi-paymentreversal-details",permalink:"/docs/student/best-practices/studentapi-paymentreversal-details",draft:!1,editUrl:"https://github.com/OneComputerGuy/anthologydevdocs/tree/main/docs/student/best-practices/PaymentReversalUsingAPI.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Payment Reversals using APIs",id:"studentapi-paymentreversal-details",sidebar_position:1,author:"Jim Burns",published:"",edited:""},sidebar:"documentationSidebar",previous:{title:"Managing Areas of Study for a Student Enrollment record via APIs",permalink:"/docs/student/best-practices/studentapi-enrollmentareaofstudyapi-details"},next:{title:"Payment Partner Overview",permalink:"/docs/student/best-practices/studentapi-paymentpartner-overview"}},d={},c=[{value:"api/commands/StudentAccounts/StudentAccountTransaction/voidAccountTransactionPayment",id:"apicommandsstudentaccountsstudentaccounttransactionvoidaccounttransactionpayment",level:2},{value:"Other Notes",id:"other-notes",level:3},{value:"api/student-accounting/ledger-refund-transactions",id:"apistudent-accountingledger-refund-transactions",level:2},{value:"Authorization",id:"authorization",level:2},{value:"Conclusion",id:"conclusion",level:2}],l=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.yg)("div",t)},u=l("VersioningTracker"),h=l("AuthorBox"),p={toc:c},m="wrapper";function y(e){let{components:t,...o}=e;return(0,i.yg)(m,(0,a.A)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,i.yg)(u,{frontMatter:r,mdxType:"VersioningTracker"}),(0,i.yg)("p",null,"A common use case for integrators is the need to reverse a payment received.  Alternative terminology for a payment reversal can be to void the payment, refund the entire payment or refund a portion of the payment that was received.  The correct way to handle via the Anthology Student APIs will depend on the specific use case/requirement the integrator needs to achieve.  The two APIs that will be covered within this document are api/commands/StudentAccounts/StudentAccountTransaction/voidAccountTransactionPayment and api/student-accounting/ledger-refund-transactions.  The voidAccountTransactionPayment API can be used ONLY if the entire payment is being reversed.  The ledger-refund-transactions can be used for full or partial payment reversals.  Details of using each of these APIs are outlined below."),(0,i.yg)("h2",{id:"apicommandsstudentaccountsstudentaccounttransactionvoidaccounttransactionpayment"},"api/commands/StudentAccounts/StudentAccountTransaction/voidAccountTransactionPayment"),(0,i.yg)("p",null,"This API should be used for the use case where a payment that was received is being 100% reversed.  As stated above, if the use case is to partially reverse a payment, then this API should NOT be used.  The unit of work within this API will be to post a new transaction on the ledger card that reverses the original received payment transaction.  Additionally, there is capability to post an additional charge (if configured) for any NSF fees that will be charged to the student.  See the Auto Charges option in Configuration - Student Accounts for more information on how to auto charge a NSF fee when a payment transaction is voided."),(0,i.yg)("p",null,"The request payload for this endpoint is quite small and simple to work with.  However, a few important notes need to be made.  First is that there is a StudentSubsidiaryAccountTransactionId property defined in the request.  This should be completely ignored.  This endpoint can ONLY be used for voiding a payment transaction on the main ledger card.  If the use case is to void a payment transaction on a subsidiary ledger, then a different API needs to be used:\n(api/commands/StudentAccounts/StudentSubsidiaryAccountTransaction/voidSubsidiaryAccountPayment).  The remainder of the request needs to be populated as follows:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"StudentAccountTransactionId - set to the Id value of the payment transaction that is being voided.  This property is required and must reference a transaction that is a payment and has not previously been voided.  NOTE:  If Anthology Student is integrated with the Anthology Finance application AND the payment transaction has already been reconciled within the Bank Reconciliation feature within the Finance application, then the payment transaction will not be allowed to be voided and a validation message will be returned.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"StudentId - set to the StudentId value on the StudentAccountTransaction row that is being voided")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"StudentEnrollmentPeriodId - set to the StudentEnrollmentPeriodId value on the StudentAccountTransaction row that is being voided")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Note - set to a comment that provides the reason this payment transaction is being voided.  This property is required.  If an empty string is provided, then a validation message will be returned stating this property is required.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"ContinueIfAmountLessThanRefund - validation exists within the API that will recalculate the net amount received for the StudentAward record that the payment transaction being voided is associated to if applicable.  If the StudentAwardId property on the StudentAccountTransaction row being voided is null or 0, then this validation logic is not applicable.  If the net amount received for the StudentAward will be less than 0 after this payment is voided, then setting this property to 0 in the request will prevent the payment from being voided and return a validation message.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"IsPreviousYear - if the payment transaction being voided was reported on a 1098T tax form for a prior year, then set this value to 1."))),(0,i.yg)("h3",{id:"other-notes"},"Other Notes"),(0,i.yg)("p",null,"If the Fund Source Security feature is being used and the payment transaction being voided is associated to a StudentAward record (see above), then the user that the API call is being authenticated under must have Void permission set for the fund source associated to the StudentAward record. If not, then a validation message will be returned and the payment transaction will not be able to be voided."),(0,i.yg)("p",null,(0,i.yg)("img",{alt:"PaymentReversal",src:n(15114).A,width:"1916",height:"860"})),(0,i.yg)("p",null,"If the payment transaction being voided is associated to a payment plan, then the payment plan will beadjusted to reflect the voided payment transaction as part of the unit of work.  Total amount received towards the payment plan will be reduced.  Additionally, the payment installment schedule will also be updated to show the expected payment(s) the payment being voided was associated to as being expected and not received."),(0,i.yg)("h2",{id:"apistudent-accountingledger-refund-transactions"},"api/student-accounting/ledger-refund-transactions"),(0,i.yg)("p",null,"This API can be used to partially or fully reverse a payment.  If fully reversing a payment, it is important to understand the different behavior when using this API verses the void payment transaction endpoint discussed above.  The key difference is that if reversing a payment received for a payment plan, there will be no logic executed within this API that will auto adjust the installment payment plan schedule.  Although the total amount refunded for the payment plan header record (StudentAward entity) will be updated, the detailed payment schedule will not.  Therefore, if a full payment that was made against a payment plan is being reversed, then it is recommended to use the VoidAccountTransactionPayment API discussed above.  "),(0,i.yg)("p",null,"This API endpoint is well documented in the Swagger file.  Thus, details on how to populate the request payload will not be provided here.  To access this API in Swagger, select 'Integration' in the Type dropdown and then click Refresh."),(0,i.yg)("p",null,(0,i.yg)("img",{alt:"PaymentReversal",src:n(64097).A,width:"1920",height:"816"})),(0,i.yg)("p",null,"Select Student Accounting and then you will see the ledger-refund-transactions endpoint towards the middle of the page."),(0,i.yg)("p",null,(0,i.yg)("img",{alt:"PaymentReversal",src:n(91384).A,width:"1844",height:"858"})),(0,i.yg)("p",null,'A common validation message that is received when using this API endpoint is "Refund amount cannot exceed .......".  There is another article (Refund Amount API Validation) that explains the details behind this validation message and the steps needed to resolve.'),(0,i.yg)("h2",{id:"authorization"},"Authorization"),(0,i.yg)("p",null,"In order to execute the APIs that have been discussed above, proper authorization needs to be configured.  Whether using Basic Auth or OAuth with application key to authenticate, the user context the APIs are executing under will be a user record from the Staff entity.  This is the user that authorization needs to be configured for.    Access to the security console application is needed in order to set the needed permissions.  In order to execute the VoidAccountTransactionPayment API, the user must be authorized for the Student Accounts - Student Account Transaction - Edit task."),(0,i.yg)("p",null,(0,i.yg)("img",{alt:"PaymentReversal",src:n(70999).A,width:"1482",height:"934"})),(0,i.yg)("p",null,"In order for the user to execute the ledger-refund-transactions API, the user must be authorized to the API - Student Accounting task."),(0,i.yg)("p",null,(0,i.yg)("img",{alt:"PaymentReversal",src:n(81006).A,width:"1482",height:"934"})),(0,i.yg)("h2",{id:"conclusion"},"Conclusion"),(0,i.yg)("p",null,"There can likely be additional nuances/details around utilizing the these APIs that are not covered within this document.  If there are any questions after reviewing this document, you can submit them by sending an email to ",(0,i.yg)("a",{parentName:"p",href:"mailto:developers@anthology.com"},"developers@anthology.com"),"."),(0,i.yg)(h,{frontMatter:r,mdxType:"AuthorBox"}))}y.isMDXComponent=!0},15114:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/PaymentReversalUsingAPI1-a5d0b91e6b29c90917eedbe5687edbe2.png"},64097:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/PaymentReversalUsingAPI2-ce9f81cc1681c07ea13dc0a45b598298.png"},91384:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/PaymentReversalUsingAPI3-de3b300b7e319e54a72b22e80cdc4ad2.png"},70999:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/PaymentReversalUsingAPI4-3900ad1cc940fc325bda1b310e58c76d.png"},81006:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/PaymentReversalUsingAPI5-434550b46c8e19386ddb81a7d20975c3.png"}}]);