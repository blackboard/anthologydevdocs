"use strict";(self.webpackChunkanthology_dev_docs=self.webpackChunkanthology_dev_docs||[]).push([[9180],{15680:(e,t,o)=>{o.d(t,{xA:()=>p,yg:()=>m});var a=o(96540);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function l(e,t){if(null==e)return{};var o,a,n=function(e,t){if(null==e)return{};var o,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var s=a.createContext({}),c=function(e){var t=a.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var o=e.components,n=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(o),h=n,m=u["".concat(s,".").concat(h)]||u[h]||d[h]||r;return o?a.createElement(m,i(i({ref:t},p),{},{components:o})):a.createElement(m,i({ref:t},p))}));function m(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=o.length,i=new Array(r);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:n,i[1]=l;for(var c=2;c<r;c++)i[c]=o[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,o)}h.displayName="MDXCreateElement"},75824:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var a=o(58168),n=(o(96540),o(15680));const r={title:"Blackboard AMI From VMDK",id:"developer-amifromvmdk",author:"Mark Kauffman",published:"2014-11-19",edited:"2024-11-19"},i=void 0,l={unversionedId:"developer-amifromvmdk",id:"developer-amifromvmdk",title:"Blackboard AMI From VMDK",description:"VMDK Availability",source:"@site/docs/developer-amifromvmdk.md",sourceDirName:".",slug:"/developer-amifromvmdk",permalink:"/docs/developer-amifromvmdk",draft:!1,editUrl:"https://github.com/blackboard/anthologydevdocs/tree/main/docs/developer-amifromvmdk.md",tags:[],version:"current",frontMatter:{title:"Blackboard AMI From VMDK",id:"developer-amifromvmdk",author:"Mark Kauffman",published:"2014-11-19",edited:"2024-11-19"},sidebar:"documentationSidebar",previous:{title:"Blackboard Learn Sandbox environment",permalink:"/docs/developer-ami"},next:{title:"Student REST API: First Steps",permalink:"/docs/student/getting-started/first-steps"}},s={},c=[{value:"VMDK Availability",id:"vmdk-availability",level:3},{value:"Introduction and Prerequisites",id:"introduction-and-prerequisites",level:4},{value:"Overview",id:"overview",level:4},{value:"Steps to Convert the .vmdk File to an AMI",id:"steps-to-convert-the-vmdk-file-to-an-ami",level:4}],p={toc:c},u="wrapper";function d(e){let{components:t,...r}=e;return(0,n.yg)(u,(0,a.A)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,n.yg)("h3",{id:"vmdk-availability"},"VMDK Availability"),(0,n.yg)("admonition",{title:"VMDK availability",type:"danger"},(0,n.yg)("p",{parentName:"admonition"},"NOTE: If you are on this page and have not yet downloaded the .vmdk file from support.anthology.com please visit that site. Login if you have an account and look for the button on the page titled ","[New Way to Access Blackboard AMI]",' and click it. You could also use the search tool to find the article "New Way to Access Blackboard AMI."  If you do not have an account, that\'s OK!! In that case you will be required to fill out a form with contact informaiton prior to your download. The rest of this document explains what the .vmdk file is and how you use it to create a Blackboard AMI in your AWS account.')),(0,n.yg)("h4",{id:"introduction-and-prerequisites"},"Introduction and Prerequisites"),(0,n.yg)("p",null,"We've developed a means to distribute the Blackboard AMI without the use of the Amazon Marketplace, or managed access to our AWS S3 buckets. To do so we now publish a .vmdk file on our support portal for the Blackboard build that you download and then convert to an AMI in your AWS account. The curent .vmdk file, export-ami-41d97b8a1a2a1dc6t.vmdk, is for Blackboard Learn 3900.106."),(0,n.yg)("p",null,"This document explains how you take the .vmdk file you\u2019ve downloaded and convert it into an AMI in your AWS account. The major prerequisite is that you will need to have your desktop/laptop configured to use the AWS Command Line Interface (CLI).  Several steps only function using the CLI. Refer to ",(0,n.yg)("a",{parentName:"p",href:"https://aws.amazon.com/cli/"},"https://aws.amazon.com/cli/")," If you have any issues with the AWS CLI review the Amazon documentation and/or reach out to Amazon for support. Another prerequisite is a good, stable, internet connection. The file is large, close to 10GB, and can take an hour or so to upload @ 22MBPS. "),(0,n.yg)("p",null,"You will need to download the .vmdk file from support.anthology.com before proceeding with the instructions in this document. If you've a support.anthology.com account login and then find the button on the home page titled ","[New Way to Access Blackboard AMI]",". Click the button, on the page that comes up read and accept the terms, then at the bottom click the accept button. Your download will start. If you don't have a support.anthology.com account you can find the button and accept the terms, and you will have an additional step of filling out a form with your contact information. Once you've filled out the form your download will start. NOTE: THE DOWNLOAD CAN TAKE BETWEEN AN HOUR OR TWO. Have a good internet connection"),(0,n.yg)("h4",{id:"overview"},"Overview"),(0,n.yg)("p",null,"An overview of the process that you will be doing, once you have the .vmdk file, is as follows. You will create an S3 bucket in your AWS account to which you will upload the .vmdk file. You will configure your AWS account policies so that you can use the CLI to convert the .vmdk file to a snapshot. You will create a configuration file on your desktop/laptop named containers.json that contains the JSON configuration for converting the .vmdk file in the S3 bucket into a Snapshot. You can then use the graphical dashboard to create an AMI associated with the Snapshot."),(0,n.yg)("h4",{id:"steps-to-convert-the-vmdk-file-to-an-ami"},"Steps to Convert the .vmdk File to an AMI"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Configure the AWS CLI for your AWS account. See ",(0,n.yg)("a",{parentName:"li",href:"https://aws.amazon.com/cli/"},"https://aws.amazon.com/cli/")," The CLI MUST be used for some steps. This is not optional."),(0,n.yg)("li",{parentName:"ol"},"Test that you can use the CLI to view your S3 buckets from your terminal:",(0,n.yg)("ol",{parentName:"li"},(0,n.yg)("li",{parentName:"ol"},"aws s3 ls "),(0,n.yg)("li",{parentName:"ol"},"Expected result: you get a list of S3 buckets."))),(0,n.yg)("li",{parentName:"ol"},"Use the GUI or CLI to create an S3 bucket, with all of the settings as the default, in your AWS account named learnexports."),(0,n.yg)("li",{parentName:"ol"},"Upload the .vmdk file that will be used to create an AMI into the learnexports bucket. This will take some time, between an hour and a couple of hours depending on your network speed. You may continue here to configure your AWS account during the upload process."),(0,n.yg)("li",{parentName:"ol"},"Once you have a learnexports bucket in S3, configure your AWS IAM as follows using the GUI:",(0,n.yg)("ol",{parentName:"li"},(0,n.yg)("li",{parentName:"ol"},"Select the IAM service to get the IAM > Dashboard"),(0,n.yg)("li",{parentName:"ol"},"Under Access management in the left nav, select policies"),(0,n.yg)("li",{parentName:"ol"},"Click ","[Create policy]"),(0,n.yg)("li",{parentName:"ol"},"On the Specify permissions page, click the ","[JSON]"," button."),(0,n.yg)("li",{parentName:"ol"},"Using the JSON policy editor, input the following JSON:")))),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre"},'{\n   "Version": "2012-10-17",\n   "Statement": [\n      {\n         "Effect": "Allow",\n         "Action": [\n            "s3:GetBucketLocation",\n            "s3:GetObject",\n            "s3:ListBucket",\n            "s3:PutObject",\n            "s3:GetBucketAcl"\n         ],\n         "Resource": [\n"arn:aws:s3:::learnexports",\n            "arn:aws:s3:::learnexports/*"\n         ]\n      },\n      {\n         "Effect": "Allow",\n         "Action": [\n            "ec2:ModifySnapshotAttribute",\n            "ec2:CopySnapshot",\n            "ec2:RegisterImage",\n            "ec2:Describe*"\n         ],\n         "Resource": "*"\n      }\n   ]\n}\n')),(0,n.yg)("ol",{start:6},(0,n.yg)("li",{parentName:"ol"},"Hit ","[Next]"," then on the Review and create page set the Policy Name to avmimportpolicy. Click ","[Create policy]"," at the bottom of the page."),(0,n.yg)("li",{parentName:"ol"},"In the IAM left nav, under \u201cAccess management\u201d click \u201cRoles\u201d."),(0,n.yg)("li",{parentName:"ol"},"Click ","[Create role]"," in the upper right of the page."),(0,n.yg)("li",{parentName:"ol"},"Trusted entity type is AWS service.  See screenshot below.")),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"AWS Trusted Entity",src:o(96482).A,width:"341",height:"166"})),(0,n.yg)("ol",{start:10},(0,n.yg)("li",{parentName:"ol"},"In the Use case section, select the EC2 service. Click ","[Next]","."),(0,n.yg)("li",{parentName:"ol"},"Now you are on the \u201cAdd permissions\u201d page. Use the Search to find the avmimportpolicy you just created in steps 4 and 5. Check the box next to it. Then click ","[Next]","."),(0,n.yg)("li",{parentName:"ol"},"Now you are on the \u201cName, review, and create\u201d page. "),(0,n.yg)("li",{parentName:"ol"},"At the top, under Role details, YOU MUST NAME THE ROLE vmimport  <- exactly this. Nothing else! Leave everything else as the default and scroll to the bottom of the page."),(0,n.yg)("li",{parentName:"ol"},"Click ","[Create role]"," at the bottom right of the page."),(0,n.yg)("li",{parentName:"ol"},"Now use the Search to find the vmimport role you just created. Click on its link."),(0,n.yg)("li",{parentName:"ol"},"Click on the \u201cTrust relationships\u201d tab just to the right of \u201cPermissions\u201d"),(0,n.yg)("li",{parentName:"ol"},"Click the ","[Edit trust policy]"," button."),(0,n.yg)("li",{parentName:"ol"}," Replace ALL of the JSON shown with the following JSON:")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre"},'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Effect": "Allow",\n            "Principal": {\n                "Service": "ec2.amazonaws.com"\n            },\n            "Action": "sts:AssumeRole"\n        },\n        {\n            "Effect": "Allow",\n            "Principal": {\n                "Service": "vmie.amazonaws.com"\n            },\n            "Action": "sts:AssumeRole",\n            "Condition": {\n                "StringEquals": {\n                    "sts:Externalid": "vmimport"\n                }\n            }\n        }\n    ]\n}\n')),(0,n.yg)("ol",{start:19},(0,n.yg)("li",{parentName:"ol"},"At the bottom right of the page, click the ","[Update policy]"," button. You have finished configuring the necessary IAM policies and roles so you can convert a .vmdk file into a snapshot that can be used to create an AMI. Now proceed to do so."),(0,n.yg)("li",{parentName:"ol"},"Create a containers.json file in a directory on your laptop/desktop computer. The file should contain the following JSON for the 3900.104 VMDK. You will replace the Description and the export-ami- lines with the current values for each release.")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre"},'{\n    "Description": "Learn3900104VMDK",\n    "Format": "VMDK",\n    "UserBucket": {\n        "S3Bucket": "learnexports",\n        "S3Key": "export-ami-0e0a6b40cd7b773ca.vmdk"\n    }\n}\n')),(0,n.yg)("ol",{start:21},(0,n.yg)("li",{parentName:"ol"},"Use the CLI to convert the .vmdk into a Snapshot.",(0,n.yg)("ol",{parentName:"li"},(0,n.yg)("li",{parentName:"ol"},'aws ec2 import-snapshot --description "Learn3900100VM" --disk-container "file:///Users/mkauffman/work/bbami/3900.100.0/containers.json"'),(0,n.yg)("li",{parentName:"ol"},"See aws ec2 import-snapshot documentation. You need the full path to your containers.json file"),(0,n.yg)("li",{parentName:"ol"},"This will create a snapshot file for you."),(0,n.yg)("li",{parentName:"ol"},'JSON output will include a line like: "ImportTaskId": "import-snap-084a4afb185bedc98" <- NOTE the taskId. You will use it in the next step.'))),(0,n.yg)("li",{parentName:"ol"},"Use the CLI to monitor the conversion of the .vmdk to a snapshot.",(0,n.yg)("ol",{parentName:"li"},(0,n.yg)("li",{parentName:"ol"},"aws ec2 describe-import-snapshot-tasks --import-task-ids import-snap-084a4afb185bedc98"),(0,n.yg)("li",{parentName:"ol"},"Use the task Id you got from the prior step."),(0,n.yg)("li",{parentName:"ol"},'Eventually,after a few minutes, you will get JSON output with \u201cStatus\u201d: \u201ccompleted\u201d and, for example a \u201cSnapshotId\u201d: "snap-04465254a72c30c82"  '))),(0,n.yg)("li",{parentName:"ol"},"Look in the EC2 section of your AWS GUI for the Snaphshots link. You will see the snapshot you just created. Check the box next to it, then under the Actions menu select \u201cCreate image from snapshot.\u201d See the following screenshot.")),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"AWS Create Image From Snapshot",src:o(50297).A,width:"468",height:"220"})),(0,n.yg)("ol",{start:24},(0,n.yg)("li",{parentName:"ol"},"On the \u201cCreate image from snapshot\u201d form give the image a meaningful Name, Ex:  \u201c3900.100 Blackboard REST AMI from Snap 04465254a72c30c82\u201d, and a similar Description.  Click the ","[Create image]"," button at the bottom of the page."),(0,n.yg)("li",{parentName:"ol"},"You should see a message indicating that the AMI has been created. Under Images in the EC2 dashboard left navigation, click AMIs. You will find the AMI you just created from the snapshot. You can copy the AMI name to the Name field.")),(0,n.yg)("p",null,(0,n.yg)("img",{alt:"AWS Created AMI Complete",src:o(19058).A,width:"395",height:"193"})),(0,n.yg)("ol",{start:26},(0,n.yg)("li",{parentName:"ol"},"You can now Use the Blackboard REST and LTI Developer AMI as per ",(0,n.yg)("a",{parentName:"li",href:"/docs/developer-ami#use-the-blackboard-rest-and-lti-developer-ami"},"Use the Blackboard REST and LTI Developer AMI"),"."),(0,n.yg)("li",{parentName:"ol"},"NOTE: Make certain to have a security policy on your EC2 instance that allows HTTP and HTTPS traffic from anywhere. Let\u2019s Encrypt will not function correctly without HTTP being open.")))}d.isMDXComponent=!0},50297:(e,t,o)=>{o.d(t,{A:()=>a});const a=o.p+"assets/images/AWSCreateImageFromSnapshot-13e958286dc0a6b2ca5238c8c91052f4.png"},19058:(e,t,o)=>{o.d(t,{A:()=>a});const a=o.p+"assets/images/AWSCreatedAMIComplete-ca913911708639810902e73e9e69ddf0.png"},96482:(e,t,o)=>{o.d(t,{A:()=>a});const a=o.p+"assets/images/AWSTrustedEntity-512237875162e7d2c0d794e6d152866c.png"}}]);